type label = string

module Label : sig

  val fresh : unit -> label
  val or-fresh : label option -> label

end = struct

  let or-fresh =
    let-mutable count <- 0 in
    let or opt =
      match opt with
      | None ->
        let () = increment count in
        `generated:` ^ arabic !count
      | Some l -> l
    in
    or

  let fresh () = or-fresh None

end
